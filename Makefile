WORMCHAIN_PATH=../wormhole/wormchain/
WORM_CLIENT_PATH=../wormhole/clients/js

CORE_ADDR=wormhole1ghd753shjuwexxywmgs4xz7x2q732vcnkm6h2pyv9s6ah3hylvrqtm7t3h
TB_ADDR=wormhole1eyfccmjm6732k7wp4p6gdjwhxjwsvje44j0hfx8nkgrm8fs7vqfssvpdkx
IBC_TR_ADDR=wormhole1wn625s4jcmvk0szpl85rj5azkfc6suyvf75q6vrddscjdphtve8sca0pvl
GA_ADDR=wormhole14hj2tavq8fpesdwxxcu44rty3hh90vhujrvcmstl4zr3txmfvw9srrg465
CW_ADDR=wormhole1fyr2mptjswz4w6xmgnpgm93x0q4s4wdl6srv3rtz3utc4f6fmxeq2msx3t

BASE_VAA=01000000000000000001000001a50001c69a1b1a65dd336bf1df6a77afb501fc25db7fc0938cb08595a9ef473265cb4f000000000517937500010000000000000000000000000000000000000000000000000000000005f5e100165809739240a0ac03b98440fe8985548e3aa683cd0d4d9df5b5659669faa3010001000000000000000000000000c10820983f33456ce7beb3a046f5a83fa34f027d0c200000000000000000000000000000000000000000000000000000000000000000

ATTEST_VAA=AQAAAAABAKoxcgK6/q+6ZrqH8iX+ejpAsexkyu2wxI+KHB5ktmxDaajVSjbtL70c4jPyDCw7BYUG5hmQ+EIsuyGJiZGGNaEBAAAAAQAAAAEAAcaaGxpl3TNr8d9qd6+1Afwl23/Ak4ywhZWp70cyZctPAAAAAAUXk3QAAhZYCXOSQKCsA7mEQP6JhVSOOqaDzQ1NnfW1ZZZp+qMBAAEGU09MVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB3U09MVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==
VAA=AQAAAAABAGNgCWY1USMq/KKRE631pyA+qNrGjXUAlsMZlQ7C2hAxJ9dYw8HDAMLpTtxFps1hQde330RHMpm7Q0MvfKEpOmcAAAAAAQABIcYAAcaaGxpl3TNr8d9qd6+1Afwl23/Ak4ywhZWp70cyZctPAAAAAAAEMSEAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7msoAFlgJc5JAoKwDuYRA/omFVI46poPNDU2d9bVllmn6owEAAXT0qkKyxtlnwEH56DlTorJxqHCMT6gNMG1sMSaG62ZPDCDGmhsaZd0za/HfanevtQH8Jdt/wJOMsIWVqe9HMmXLT3siZ2F0ZXdheV90cmFuc2ZlciI6eyJjaGFpbiI6MTgsImZlZSI6IjAiLCJub25jZSI6Nzc5OTIsInJlY2lwaWVudCI6InRlcnJhMXg0NnJxYXk0ZDNjc3NxOGd4eHZxejh4dDZud2x6NHRkMjBrMzh2In19
TEST_VAA=AQAAAAABADycSbIGmq6ZrhaiR8gbKZ7Cj7lXYNf7MUp7B53GRhkqYuT8kYnNvslrOUjYWg8ATdrkJL5R+0E0muucX59GE8QAAAAAAQABIckAAcaaGxpl3TNr8d9qd6+1Afwl23/Ak4ywhZWp70cyZctPAAAAAAAEMSMAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7msoAFlgJc5JAoKwDuYRA/omFVI46poPNDU2d9bVllmn6owEAAXT0qkKyxtlnwEH56DlTorJxqHCMT6gNMG1sMSaG62ZPDCDGmhsaZd0za/HfanevtQH8Jdt/wJOMsIWVqe9HMmXLT3siZ2F0ZXdheV90cmFuc2ZlciI6eyJjaGFpbiI6MTgsImZlZSI6IjAiLCJub25jZSI6Nzc5OTIsInJlY2lwaWVudCI6ImRHVnljbUV4ZURRMmNuRmhlVFJrTTJOemMzRTRaM2g0ZG5GNk9IaDBObTUzYkhvMGRHUXlNR3N6T0hZPSJ9fQ==
TEST_VAA_1=AQAAAAABADDxoNrDk59FPyMIOj7ADonUeIMqR4sx1TMgumfL9KZnThQbz7zI4Pj7oNwwv2WxQDlzf0jngJYXBYHVGg30/8sBAAAAAQABIckAAcaaGxpl3TNr8d9qd6+1Afwl23/Ak4ywhZWp70cyZctPAAAAAAAEMSgAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7msoAFlgJc5JAoKwDuYRA/omFVI46poPNDU2d9bVllmn6owEAAXT0qkKyxtlnwEH56DlTorJxqHCMT6gNMG1sMSaG62ZPDCDGmhsaZd0za/HfanevtQH8Jdt/wJOMsIWVqe9HMmXLT3siZ2F0ZXdheV90cmFuc2ZlciI6eyJjaGFpbiI6MTgsImZlZSI6IjAiLCJub25jZSI6Nzc5OTIsInJlY2lwaWVudCI6ImRHVnljbUV4ZURRMmNuRmhlVFJrTTJOemMzRTRaM2g0ZG5GNk9IaDBObTUzYkhvMGRHUXlNR3N6T0hZPSJ9fQ==
UPDATE_CHANNEL_VAA=AQAAAAABADgdiqQeZkn5mTv35wS2yCeaR7VuHldj+jbJE4L2w26LTvOC2MGO0IoV8H2lz8BOgXrYe76jj1Zvrmpzw26T1UwBAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAGZ2YwAAAAAAAAAAAAAAAAAAAAAAAAAAEliY1RyYW5zbGF0b3IBDCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY2hhbm5lbC0wABI=
GOV_VAA=010000000001003b67fdb2dc9cce28c5bf68bd446c8c6dcca8a21be73725109a1a16c06324aba527b407ef51cc86f72e2b174fbcf6f1993c14d4b159ff58314e8a72809437c4e40000000000000000000001000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000476174657761794d6f64756c65010c2076322e32362e300000000000000032
MW_VAA_HEX=0100000000010014b282667dbbc581f80ef601a803ec6022bdf90847bed98b2da8076b0c6b20ae6d6136edfcc2c426c7d6b94df96f7ab1508e4ebccd3c4986c8ef40570ba67cbf0100000000000000000001000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000476174657761794d6f64756c65030c2074f4aa42b2c6d967c041f9e83953a2b271a8708c4fa80d306d6c312686eb664f
OSMO_VAA=AQAAAAABAJ+hMGUcTsD9nrHyYTy+CLhMgOY2+YRDR+3I9pgZaTBKb5MLdFcZhFc5ABM8GfjtZT1IDRebh6XDJi+0AWLrc+UBAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAKAWU4AAAAAAAAAAAAAAAAAAAAAAAAAAEliY1RyYW5zbGF0b3IBDCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY2hhbm5lbC0wABQ=
COMPLETE_OSMO=AQAAAAABAN08P2UXHowrRpAcm+uNul/45kCi4JZsAWOvQiVTdGVsbcPSZ+xjFA6jiyiw8nRQql1jYXY5dC5VOsIP93d73lEBAAAAAQABIckAAcaaGxpl3TNr8d9qd6+1Afwl23/Ak4ywhZWp70cyZctPAAAAAAAEMScAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7msoAFlgJc5JAoKwDuYRA/omFVI46poPNDU2d9bVllmn6owEAAXT0qkKyxtlnwEH56DlTorJxqHCMT6gNMG1sMSaG62ZPDCDGmhsaZd0za/HfanevtQH8Jdt/wJOMsIWVqe9HMmXLT3siZ2F0ZXdheV90cmFuc2ZlciI6eyJjaGFpbiI6MjAsImZlZSI6IjAiLCJub25jZSI6Nzc5OTMsInJlY2lwaWVudCI6ImIzTnRiekZzZDJNMU9IRm1ibmQ1WTNjNU9UQmpkbkV3ZVdWbWJtcHhjWFpxWjJGa2JIbGhlR1J3Tmc9PSJ9fQ==
REGISTER_WC_VAA=AQAAAAABANdzCy92x5jk8o7xnXD0cFeh4ItvNdfv9oNR9Chd7cvCBRHY1JYEF3WJ8FENfWonrYaLiysfKSvgRFKjqP5fX/IBAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAXjxZIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVG9rZW5CcmlkZ2UBAAAMIMkTjG5b16KrecGodIbJ1zSdBks1rJ90mPOyB7OmHmAT

WILD_CARD=*

FROM=wormhole1cyyzpxplxdzkeea7kwsydadg87357qna3zg3tq
SIGN_SEND_FLAGS=--chain-id wormchain -bblock  --yes --gas-adjustment=1.2 --gas=auto --from $(FROM)
NODE=--node=http://localhost:26659/

MESSAGE_TRANSFER='{"complete_transfer_and_convert":{"vaa":"$(COMPLETE_OSMO)"}}'
complete-ibc-transfer:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind --trace \
	tx wasm execute $(IBC_TR_ADDR) \
	$(MESSAGE_TRANSFER) \
	$(NODE) \
	$(SIGN_SEND_FLAGS)

TRANSFER_INFO_MESSAGE='{"transfer_info":{"vaa":"$(WILD_CARD)"}}'
get-transfer-info:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	q wasm contract-state smart --trace $(TB_ADDR) \
	$(TRANSFER_INFO_MESSAGE) \
	$(NODE) -o json | jq .

QUERY_CHANNEL_MESSAGE='{"ibc_channel":{"chain_id": $(CHAIN_ID)}}'
get-ibc-channel-info:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	q wasm contract-state smart --trace $(IBC_TR_ADDR) \
	$(QUERY_CHANNEL_MESSAGE) \
	$(NODE) -o json | jq .

PV_MESSAGE='{"verify_v_a_a":{"vaa":"$(WILD_CARD)", "block_time": 14145 }}'
parse-verify-vaa:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	q wasm contract-state smart --trace $(CORE_ADDR) \
	$(PV_MESSAGE) \
	$(NODE)

GS_MESSAGE='{"guardian_set_info":{}}'
query-guardian-set:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	q wasm contract-state smart --trace $(CORE_ADDR) \
	$(GS_MESSAGE) \
	$(NODE)


ATTEST_MESSAGE='{"submit_vaa":{"data":"$(ATTEST_VAA)"}}'
attest-token:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	tx wasm execute $(TB_ADDR) \
	$(ATTEST_MESSAGE) \
	$(NODE) \
	$(SIGN_SEND_FLAGS)

check-cw20-instances:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	q wasm list-contract-by-code 6 --node http://localhost:26659 -o json | jq .

UPDATE_CHANNEL_INFO_MSG='{"submit_update_chain_to_channel_map":{"vaa":"$(OSMO_VAA)"}}'
update-channel-info:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	tx wasm execute $(IBC_TR_ADDR) \
	$(UPDATE_CHANNEL_INFO_MSG) \
	$(NODE) \
	$(SIGN_SEND_FLAGS)

check-channel-info:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	q wasm contract-state smart $(IBC_TR_ADDR) \
	'{"ibc_channel": {"chain_id": 20}}' \
	$(NODE)


NEW_PAYLOAD=03000000000000000000000000000000000000000000000000000000003b9aca00165809739240a0ac03b98440fe8985548e3aa683cd0d4d9df5b5659669faa301000174f4aa42b2c6d967c041f9e83953a2b271a8708c4fa80d306d6c312686eb664f0c20c69a1b1a65dd336bf1df6a77afb501fc25db7fc0938cb08595a9ef473265cb4f7b22676174657761795f7472616e73666572223a7b22636861696e223a31382c22666565223a2230222c226e6f6e6365223a37373939322c22726563697069656e74223a225b302c202020302c202020302c202020302c202020302c202020302c202020302c202020302c202020302c302c202020302c202020302c202035332c203131362c202034382c203131362c203134392c203130382c3131332c202020382c202020302c203233322c202034392c203135322c202020312c202032382c203230332c3231322c203232312c203234312c202038352c203130395d227d7d
edit-vaa:
	cd $(WORM_CLIENT_PATH) && worm edit-vaa -n devnet \
	--gsi 0 \
	--nonce 74182 \
	--ec 1 \
	--ea 0xc69a1b1a65dd336bf1df6a77afb501fc25db7fc0938cb08595a9ef473265cb4f \
	--seq 274721 \
	--payload $(NEW_PAYLOAD) \
	--gs cfb12303a19cde580bb4dd771639b0d26bc68353645571a8cff516ab2ee113a0 \
	--vaa $(BASE_VAA)

sign-vaa:
	cd $(WORM_CLIENT_PATH) && worm edit-vaa -n devnet \
	--gs cfb12303a19cde580bb4dd771639b0d26bc68353645571a8cff516ab2ee113a0 \
	--vaa $(RAW_VAA)

gov-schedule-upgrade:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind --trace \
	tx wormhole execute-gateway-governance-vaa $(GOV_VAA) \
	$(NODE) \
	$(SIGN_SEND_FLAGS)

gov-set-mw:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind --trace \
	tx wormhole execute-gateway-governance-vaa $(MW_VAA_HEX) \
	$(NODE) \
	$(SIGN_SEND_FLAGS)

check-chain-registration:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	q wasm contract-state smart $(GA_ADDR) \
	'{"chain_registration": {"chain": 3104}}' \
	$(NODE)

MESSAGE='{"submit_vaas":{"vaas":["$(WILD_CARD)"]}}'
register-wc-to-ga:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind --trace \
	tx wasm execute $(GA_ADDR) \
	$(MESSAGE) \
	$(NODE) \
	$(SIGN_SEND_FLAGS)

 
pending-transfers:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	q wasm contract-state smart $(GA_ADDR) \
	'{"all_pending_transfers": {}}' \
	$(NODE)

wrapped-asset-info:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	q wasm contract-state smart $(CW_ADDR) \
	'{"wrapped_asset_info": {}}' \
	$(NODE)

check-mw-contract:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	q wormhole show-ibc-composability-mw-contract \
	$(NODE) -o json

check-all-accounts:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	q wasm contract-state smart $(GA_ADDR) \
	'{"all_accounts": {}}' \
	$(NODE)

# Look for channel-0 counterparty channel_id
check-wormchain-channels:
	cd $(WORMCHAIN_PATH) && ./build/wormchaind \
	q ibc channel channels \
	$(NODE)

# Remember to update the channel_id of the denom-trace
check-osmosis-ibc-denom:
	/Users/jorgelopes/go/bin/osmosisd q ibc-transfer denom-hash \
	transfer/channel-10219/factory/wormhole1wn625s4jcmvk0szpl85rj5azkfc6suyvf75q6vrddscjdphtve8sca0pvl/5v4fjb5bdUNdEaXovRXeandqPwrV5oVeqGigAikMmuxm \
	--node https://rpc.testnet.osmosis.zone:443
